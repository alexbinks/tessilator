
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>clean_lc &#8212; tessilator 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pyramid.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <script src="../_static/jquery.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="detrend_lc" href="tessilator.lc_analysis.detrend_lc.html" />
    <link rel="prev" title="aper_run" href="tessilator.lc_analysis.aper_run.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tessilator.lc_analysis.detrend_lc.html" title="detrend_lc"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tessilator.lc_analysis.aper_run.html" title="aper_run"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">tessilator 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../howtouse.html" accesskey="U">How to use</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">clean_lc</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="clean-lc">
<h1>clean_lc<a class="headerlink" href="#clean-lc" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="tessilator.lc_analysis.clean_lc">
<span class="sig-prename descclassname"><span class="pre">tessilator.lc_analysis.</span></span><span class="sig-name descname"><span class="pre">clean_lc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAD_fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_num_per_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tessilator/lc_analysis.html#clean_lc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tessilator.lc_analysis.clean_lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove data points from the lightcurve that are likely to be spurious.</p>
<p>Many lightcurves have a 1 or 2 day gap. To avoid systematic offsets and
ensure the data is efficiently normalized, the lightcurve is split into
“strings” of contiguous data. Neighbouring data points must have been
observed within 10 times the median absolute deviation of the time
difference between each observation.</p>
<p>The start and end point of each data section must have a flux value within
a given number of MAD from the median flux in the sector. This is done
because often after large time gaps the temperature of the sensors changes,
and including these components is likely to just result in a signal from
instrumental noise.</p>
<p>The function returns the start and end points for each data section in the
sector, which must contain a chosen number of data points. This is to
ensure there are enough datapoints to construct a periodogram analysis.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>t</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable"><strong>Iterable</strong></a></span></dt><dd><p>The set of time coordinates (in days)</p>
</dd>
<dt><strong>f</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable"><strong>Iterable</strong></a></span></dt><dd><p>The set of normalised flux coordinates</p>
</dd>
<dt><strong>MAD_fac</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float"><strong>float</strong></a>, optional, default=2.</span></dt><dd><p>The threshold number of MAD values to allow.</p>
</dd>
<dt><strong>time_fac</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float"><strong>float</strong></a>, optional, default=10.</span></dt><dd><p>The maximum time gap allowed between neighbouring datapoints.</p>
</dd>
<dt><strong>min_num_per_group</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int"><strong>int</strong></a>, optional, default=50</span></dt><dd><p>The minimum number of datapoints allowed in a contiguous set.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>start_index</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/tutorial/datastructures.html"><strong>list</strong></a></span></dt><dd><p>The start indices for each saved data string.</p>
</dd>
<dt><strong>end_index</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/tutorial/datastructures.html"><strong>list</strong></a></span></dt><dd><p>The end indices for each saved data string.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">clean_lc</a><ul>
<li><a class="reference internal" href="#tessilator.lc_analysis.clean_lc"><code class="docutils literal notranslate"><span class="pre">clean_lc()</span></code></a></li>
</ul>
</li>
</ul>

  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tessilator.lc_analysis.detrend_lc.html" title="detrend_lc"
             >next</a> |</li>
        <li class="right" >
          <a href="tessilator.lc_analysis.aper_run.html" title="aper_run"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">tessilator 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../howtouse.html" >How to use</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">clean_lc</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Alex Binks &amp; Moritz Guenther.
      Last updated on 16 Mar 2023.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3.
    </div>
  </body>
</html>